%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Granger_pairwise_exclude_futures.m
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% Last modified: 05-24-2012

clear;

%%%%%%%%%%%%%%%%%%%%%%%%%%
% Germany, 1990:12-2010:12
%%%%%%%%%%%%%%%%%%%%%%%%%%

daily_futures_DEU=xlsread('Returns_international_data_1980_2010',...
    'DEU futures price index, daily','a2:d5263'); % 1990:11-2010:12
[return_DEU]=Compute_return_exclude_last_day(daily_futures_DEU,...
    0); % 1990:12-2010:12
bill_lag_DEU=xlsread('Returns_international_data_1980_2010',...
    'T-bill yield--GFD','e132:e372'); % 1990:11-2010:11
equity_premium_DEU=100*return_DEU-(1/12)*bill_lag_DEU; % 1990:12-2010:12
bill_DEU=xlsread('Returns_international_data_1980_2010',...
    'T-bill yield--GFD','e133:e373'); % 1990:12-2010:12
DY_DEU=xlsread('Returns_international_data_1980_2010',...
    'Dividend yield--GFD','e133:e373'); % 1990:12-2010:12
dy_DEU=log(DY_DEU);
daily_futures_USA=xlsread('Returns_international_data_1980_2010',...
    'USA futures price index, daily','a2226:d7487'); % 1990:11-2010:12
[return_USA]=Compute_return_exclude_last_day(daily_futures_USA,...
    1); % 1990:12-2010:12
bill_lag_USA=xlsread('Returns_international_data_1980_2010',...
    'T-bill yield--GFD','l132:l372'); % 1990:11-2010:11
equity_premium_USA=100*return_USA-(1/12)*bill_lag_USA; % 1990:12-2010:12
Y_futures_DEU=equity_premium_DEU(2:end);
X_futures_DEU=[equity_premium_USA(1:end-1) equity_premium_DEU(1:end-1) ...
    bill_DEU(1:end-1) dy_DEU(1:end-1) ones(size(Y_futures_DEU,1),1)];
results_futures_DEU=nwest(Y_futures_DEU,X_futures_DEU,0);
tstat_p_futures_DEU=1-norm_cdf(results_futures_DEU.tstat(1),0,1);
equity_premium_DEU=xlsread('Returns_international_data_1980_2010',...
    'Equity premium--GFD','e132:e372'); % 1990:12-2010:12
equity_premium_DEU=100*equity_premium_DEU;
equity_premium_USA=xlsread('Returns_international_data_1980_2010',...
    'Equity premium (exclude)--GFD','l132:l372'); % 1990:12-2010:12
equity_premium_USA=100*equity_premium_USA;
Y_spot_DEU=equity_premium_DEU(2:end);
X_spot_DEU=[equity_premium_USA(1:end-1) equity_premium_DEU(1:end-1) ...
    bill_DEU(1:end-1) dy_DEU(1:end-1) ones(size(Y_spot_DEU,1),1)];
results_spot_DEU=nwest(Y_spot_DEU,X_spot_DEU,0);
tstat_p_spot_DEU=1-norm_cdf(results_spot_DEU.tstat(1),0,1);
results_DEU=[results_spot_DEU.beta(1) results_futures_DEU.beta(1) ; ...
    results_spot_DEU.tstat(1) results_futures_DEU.tstat(1) ; ...
    tstat_p_spot_DEU tstat_p_futures_DEU ; ...
    100*results_spot_DEU.rsqr 100*results_futures_DEU.rsqr];
%xlswrite('Returns_international_results_1980_2010',results_DEU,...
%    'Granger causality--GFD','as19');

%%%%%%%%%%%%%%%%%%%%%%%%
% Japan, 1988:10-2010:12
%%%%%%%%%%%%%%%%%%%%%%%%

daily_futures_JPN=xlsread('Returns_international_data_1980_2010',...
    'JPN futures price index, daily','a2:d5825'); % 1988:09-2010:12
[return_JPN]=Compute_return_exclude_last_day(daily_futures_JPN,...
    0); % 1988:10-2010:12
bill_lag_JPN=xlsread('Returns_international_data_1980_2010',...
    'T-bill yield--GFD','g106:g372'); % 1988:09-2010:11
equity_premium_JPN=100*return_JPN-(1/12)*bill_lag_JPN; % 1988:10-2010:12
bill_JPN=xlsread('Returns_international_data_1980_2010',...
    'T-bill yield--GFD','g107:g373'); % 1988:10-2010:12
DY_JPN=xlsread('Returns_international_data_1980_2010',...
    'Dividend yield--GFD','g107:g373'); % 1988:10-2010:12
dy_JPN=log(DY_JPN);
daily_futures_USA=xlsread('Returns_international_data_1980_2010',...
    'USA futures price index, daily','a1661:d7487'); % 1988:09-2010:12
[return_USA]=Compute_return_exclude_last_day(daily_futures_USA,...
    1); % 1988:10-2010:12
bill_lag_USA=xlsread('Returns_international_data_1980_2010',...
    'T-bill yield--GFD','l106:l372'); % 1988:09-2010:11
equity_premium_USA=100*return_USA-(1/12)*bill_lag_USA; % 1988:10-2010:12
Y_futures_JPN=equity_premium_JPN(2:end);
X_futures_JPN=[equity_premium_USA(1:end-1) equity_premium_JPN(1:end-1) ...
    bill_JPN(1:end-1) dy_JPN(1:end-1) ones(size(Y_futures_JPN,1),1)];
results_futures_JPN=nwest(Y_futures_JPN,X_futures_JPN,0);
tstat_p_futures_JPN=1-norm_cdf(results_futures_JPN.tstat(1),0,1);
equity_premium_JPN=xlsread('Returns_international_data_1980_2010',...
    'Equity premium--GFD','g106:g372'); % 1988:10-2010:12
equity_premium_JPN=100*equity_premium_JPN;
equity_premium_USA=xlsread('Returns_international_data_1980_2010',...
    'Equity premium (exclude)--GFD','l106:l372'); % 1988:10-2010:12
equity_premium_USA=100*equity_premium_USA;
Y_spot_JPN=equity_premium_JPN(2:end);
X_spot_JPN=[equity_premium_USA(1:end-1) equity_premium_JPN(1:end-1) ...
    bill_JPN(1:end-1) dy_JPN(1:end-1) ones(size(Y_spot_JPN,1),1)];
results_spot_JPN=nwest(Y_spot_JPN,X_spot_JPN,0);
tstat_p_spot_JPN=1-norm_cdf(results_spot_JPN.tstat(1),0,1);
results_JPN=[results_spot_JPN.beta(1) results_futures_JPN.beta(1) ; ...
    results_spot_JPN.tstat(1) results_futures_JPN.tstat(1) ; ...
    tstat_p_spot_JPN tstat_p_futures_JPN ; ...
    100*results_spot_JPN.rsqr 100*results_futures_JPN.rsqr];
%xlswrite('Returns_international_results_1980_2010',results_JPN,...
%    'Granger causality--GFD','as29');

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Netherlands, 1988:11-2010:12
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

daily_futures_NLD=xlsread('Returns_international_data_1980_2010',...
    'NLD futures price index, daily','a2:d5806'); % 1988:10-2010:12
[return_NLD]=Compute_return_exclude_last_day(daily_futures_NLD,...
    0); % 1988:11-2010:12
bill_lag_NLD=xlsread('Returns_international_data_1980_2010',...
    'T-bill yield--GFD','h107:h372'); % 1988:10-2010:11
equity_premium_NLD=100*return_NLD-(1/12)*bill_lag_NLD; % 1988:11-2010:12
bill_NLD=xlsread('Returns_international_data_1980_2010',...
    'T-bill yield--GFD','h108:h373'); % 1988:11-2010:12
DY_NLD=xlsread('Returns_international_data_1980_2010',...
    'Dividend yield--GFD','h108:h373'); % 1988:11-2010:12
dy_NLD=log(DY_NLD);
daily_futures_USA=xlsread('Returns_international_data_1980_2010',...
    'USA futures price index, daily','a1683:d7487'); % 1988:10-2010:12
[return_USA]=Compute_return_exclude_last_day(daily_futures_USA,...
    1); % 1988:11-2010:12
bill_lag_USA=xlsread('Returns_international_data_1980_2010',...
    'T-bill yield--GFD','l107:l372'); % 1988:10-2010:11
equity_premium_USA=100*return_USA-(1/12)*bill_lag_USA; % 1988:11-2010:12
Y_futures_NLD=equity_premium_NLD(2:end);
X_futures_NLD=[equity_premium_USA(1:end-1) equity_premium_NLD(1:end-1) ...
    bill_NLD(1:end-1) dy_NLD(1:end-1) ones(size(Y_futures_NLD,1),1)];
results_futures_NLD=nwest(Y_futures_NLD,X_futures_NLD,0);
tstat_p_futures_NLD=1-norm_cdf(results_futures_NLD.tstat(1),0,1);
equity_premium_NLD=xlsread('Returns_international_data_1980_2010',...
    'Equity premium--GFD','h107:h372'); % 1988:11-2010:12
equity_premium_NLD=100*equity_premium_NLD;
equity_premium_USA=xlsread('Returns_international_data_1980_2010',...
    'Equity premium (exclude)--GFD','l107:l372'); % 1988:11-2010:12
equity_premium_USA=100*equity_premium_USA;
Y_spot_NLD=equity_premium_NLD(2:end);
X_spot_NLD=[equity_premium_USA(1:end-1) equity_premium_NLD(1:end-1) ...
    bill_NLD(1:end-1) dy_NLD(1:end-1) ones(size(Y_spot_NLD,1),1)];
results_spot_NLD=nwest(Y_spot_NLD,X_spot_NLD,0);
tstat_p_spot_NLD=1-norm_cdf(results_spot_NLD.tstat(1),0,1);
results_NLD=[results_spot_NLD.beta(1) results_futures_NLD.beta(1) ; ...
    results_spot_NLD.tstat(1) results_futures_NLD.tstat(1) ; ...
    tstat_p_spot_NLD tstat_p_futures_NLD ; ...
    100*results_spot_NLD.rsqr 100*results_futures_NLD.rsqr];
%xlswrite('Returns_international_results_1980_2010',results_NLD,...
%    'Granger causality--GFD','as34');

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Switzerland, 1990:12-2010:12
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

daily_futures_CHE=xlsread('Returns_international_data_1980_2010',...
    'CHE futures price index, daily','a2:d5258'); % 1990:11-2010:12
[return_CHE]=Compute_return_exclude_last_day(daily_futures_CHE,...
    0); % 1990:12-2010:12
bill_lag_CHE=xlsread('Returns_international_data_1980_2010',...
    'T-bill yield--GFD','j132:j372'); % 1990:11-2010:11
equity_premium_CHE=100*return_CHE-(1/12)*bill_lag_CHE; % 1990:12-2010:12
bill_CHE=xlsread('Returns_international_data_1980_2010',...
    'T-bill yield--GFD','j133:j373'); % 1990:12-2010:12
DY_CHE=xlsread('Returns_international_data_1980_2010',...
    'Dividend yield--GFD','j133:j373'); % 1990:12-2010:12
dy_CHE=log(DY_CHE);
daily_futures_USA=xlsread('Returns_international_data_1980_2010',...
    'USA futures price index, daily','a2226:d7487'); % 1990:11-2010:12
[return_USA]=Compute_return_exclude_last_day(daily_futures_USA,...
    1); % 1990:12-2010:12
bill_lag_USA=xlsread('Returns_international_data_1980_2010',...
    'T-bill yield--GFD','l132:l372'); % 1990:11-2010:11
equity_premium_USA=100*return_USA-(1/12)*bill_lag_USA; % 1990:12-2010:12
Y_futures_CHE=equity_premium_CHE(2:end);
X_futures_CHE=[equity_premium_USA(1:end-1) equity_premium_CHE(1:end-1) ...
    bill_CHE(1:end-1) dy_CHE(1:end-1) ones(size(Y_futures_CHE,1),1)];
results_futures_CHE=nwest(Y_futures_CHE,X_futures_CHE,0);
tstat_p_futures_CHE=1-norm_cdf(results_futures_CHE.tstat(1),0,1);
equity_premium_CHE=xlsread('Returns_international_data_1980_2010',...
    'Equity premium--GFD','j132:j372'); % 1990:12-2010:12
equity_premium_CHE=100*equity_premium_CHE;
equity_premium_USA=xlsread('Returns_international_data_1980_2010',...
    'Equity premium (exclude)--GFD','l132:l372'); % 1990:12-2010:12
equity_premium_USA=100*equity_premium_USA;
Y_spot_CHE=equity_premium_CHE(2:end);
X_spot_CHE=[equity_premium_USA(1:end-1) equity_premium_CHE(1:end-1) ...
    bill_CHE(1:end-1) dy_CHE(1:end-1) ones(size(Y_spot_CHE,1),1)];
results_spot_CHE=nwest(Y_spot_CHE,X_spot_CHE,0);
tstat_p_spot_CHE=1-norm_cdf(results_spot_CHE.tstat(1),0,1);
results_CHE=[results_spot_CHE.beta(1) results_futures_CHE.beta(1) ; ...
    results_spot_CHE.tstat(1) results_futures_CHE.tstat(1) ; ...
    tstat_p_spot_CHE tstat_p_futures_CHE ; ...
    100*results_spot_CHE.rsqr 100*results_futures_CHE.rsqr];
%xlswrite('Returns_international_results_1980_2010',results_CHE,...
%    'Granger causality--GFD','as44');

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% United Kingdom, 1984:06-2010:12
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

daily_futures_GBR=xlsread('Returns_international_data_1980_2010',...
    'GBR futures price index, daily','a2:d6958'); % 1984:05-2010:12
[return_GBR]=Compute_return_exclude_last_day(daily_futures_GBR,...
    0); % 1984:06-2010:12
bill_lag_GBR=xlsread('Returns_international_data_1980_2010',...
    'T-bill yield--GFD','k54:k372'); % 1984:05-2010:11
equity_premium_GBR=100*return_GBR-(1/12)*bill_lag_GBR; % 1984:06-2010:12
bill_GBR=xlsread('Returns_international_data_1980_2010',...
    'T-bill yield--GFD','k55:k373'); % 1984:06-2010:12
DY_GBR=xlsread('Returns_international_data_1980_2010',...
    'Dividend yield--GFD','k55:k373'); % 1984:06-2010:12
dy_GBR=log(DY_GBR);
daily_futures_USA=xlsread('Returns_international_data_1980_2010',...
    'USA futures price index, daily','a529:d7487'); % 1984:05-2010:12
[return_USA]=Compute_return_exclude_last_day(daily_futures_USA,...
    1); % 1984:06-2010:12
bill_lag_USA=xlsread('Returns_international_data_1980_2010',...
    'T-bill yield--GFD','l54:l372'); % 1984:05-2010:11
equity_premium_USA=100*return_USA-(1/12)*bill_lag_USA; % 1984:06-2010:12
Y_futures_GBR=equity_premium_GBR(2:end);
X_futures_GBR=[equity_premium_USA(1:end-1) equity_premium_GBR(1:end-1) ...
    bill_GBR(1:end-1) dy_GBR(1:end-1) ones(size(Y_futures_GBR,1),1)];
results_futures_GBR=nwest(Y_futures_GBR,X_futures_GBR,0);
tstat_p_futures_GBR=1-norm_cdf(results_futures_GBR.tstat(1),0,1);
equity_premium_GBR=xlsread('Returns_international_data_1980_2010',...
    'Equity premium--GFD','k54:k372'); % 1984:06-2010:12
equity_premium_GBR=100*equity_premium_GBR;
equity_premium_USA=xlsread('Returns_international_data_1980_2010',...
    'Equity premium (exclude)--GFD','l54:l372'); % 1984:06-2010:12
equity_premium_USA=100*equity_premium_USA;
Y_spot_GBR=equity_premium_GBR(2:end);
X_spot_GBR=[equity_premium_USA(1:end-1) equity_premium_GBR(1:end-1) ...
    bill_GBR(1:end-1) dy_GBR(1:end-1) ones(size(Y_spot_GBR,1),1)];
results_spot_GBR=nwest(Y_spot_GBR,X_spot_GBR,0);
tstat_p_spot_GBR=1-norm_cdf(results_spot_GBR.tstat(1),0,1);
results_GBR=[results_spot_GBR.beta(1) results_futures_GBR.beta(1) ; ...
    results_spot_GBR.tstat(1) results_futures_GBR.tstat(1) ; ...
    tstat_p_spot_GBR tstat_p_futures_GBR ; ...
    100*results_spot_GBR.rsqr 100*results_futures_GBR.rsqr];
%xlswrite('Returns_international_results_1980_2010',results_GBR,...
%    'Granger causality--GFD','as49');
